"use strict";var appVue=new Vue({el:".app-vue",data:{searchResults:[],posts:[],singlePost:[],episodes:[],search:"",showSearch:!1,searchClass:!0,loadCards:!1,imdbApi:"http://www.omdbapi.com/?apikey=ed5d8acc&",wpApi:"http://marcoaring.com.br/clientes/pss/wp-json/wp/v2/",user:window.currentUser,wpAjax:window.linkAjax},created:function(){this.loadPosts(),this.loadPostSingle()},methods:{loadSearch:function(e){var s=this;this.search=e.target.value,2<=this.search.length?$.ajax({url:s.imdbApi+"s="+this.search,success:function(e){s.searchResults=e}}):s.searchResults=[]},loadPosts:function(){var t=this,e=this.getUrlParameter("type"),s=e?"&filter[meta_key]=categoria_imdb&filter[meta_value]="+e:"";console.log(e),$.ajax({url:t.wpApi+"entretenimento?author="+t.user+s,success:function(e){var a="";$.each(e,function(e,s){a=s.acf.id_imdb,$.ajax({url:t.imdbApi+"i="+a,success:function(e){t.posts.push(e)}})})}})},loadPostSingle:function(){var s=this,e=this.getUrlParameter("id");e?$.ajax({url:s.imdbApi+"i="+e,success:function(e){s.singlePost=e}}):console.log("deu ruim")},loadSeason:function(e,s){if(e&&s){var a=this;$("#season"+s+" ul");$.ajax({url:a.imdbApi+"i="+e+"&Season="+s,success:function(e){a.episodes=[],a.episodes=e.Episodes,$.each(a.episodes,function(s,e){$.ajax({url:a.wpApi+"episodes/?filter[meta_key]=id_episode&filter[meta_value]="+e.imdbID,success:function(e){0<e.length?a.$set(a.episodes[s],"watched",!0):a.$set(a.episodes[s],"watched",!1)}})}),$("html, body").stop().animate({scrollTop:$("#season"+s).parent().offset().top-55},1e3)}})}else console.log("deu ruim")},checkEpisode:function(e,s,a,t){var i=this;$.ajax({url:i.wpAjax,type:"POST",data:{action:"save_episode",titulo:e,id_serie:t,id_episode:s,author:i.user},success:function(e){e&&(i.loadSeason(t,a),M.toast({html:"EpisÃ³dio marcado como assistido.",diplayLength:6e3,classes:"rounded"}))}})},addItem:function(e){var s=this;$.ajax({url:s.wpAjax,type:"POST",data:{action:"save_item",imdbId:e,author:s.user},success:function(e){e&&(s.showSearch=!1,s.searchClass=!0,s.loadCards=!0,M.toast({html:"Item cadastrado na Biblioteca.",diplayLength:6e3,classes:"rounded"}))}})},getUrlParameter:function(e){var s=decodeURIComponent(window.location.search.substring(1)).split("&"),a=void 0,t=void 0;for(t=0;t<s.length;t++)return(a=s[t].split("="))[0]===e&&(void 0===a[1]||a[1])}},watch:{loadCards:function(){this.loadPosts(),this.loadCards=!1}}});$(document).on("click",".main-accordion__link",function(){return $(this).parent().hasClass("main-accordion__content--active")?$(this).parent().removeClass("main-accordion__content--active"):($(".main-accordion__content").removeClass("main-accordion__content--active"),$(this).parent().addClass("main-accordion__content--active")),!1});